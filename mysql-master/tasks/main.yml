---
- name: Config file for mysql
  template:
    src: my.cnf.j2
    dest: /etc/my.cnf

- name: Starting mysql
  service: name=mysqld state=restarted


- name: Mysql Configuration
  command: 'mysql -e "{{ item }}"'
  with_items:
    - CREATE DATABASE {{ master_db_name }};
    - create user '{{ user_name }}'@'%' identified by '{{ password }}';
    - grant replication slave on *.* to '{{ user_name }}'@'%';
    - update mysql.user set Repl_client_priv='Y' where user= '{{ user_name }}';
    - FLUSH PRIVILEGES;
 

- name: Config file for mysql
  template:
    src: sql.sh.j2
    dest: /root/sql.sh
    
- name: run the script
  command: bash /root/sql.sh 	

- name: copy a file from remote server
  fetch:
    src: /root/output.txt
    dest: /etc/ansible/roles/output.txt
    flat: yes







